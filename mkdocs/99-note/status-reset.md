ステータスリセットのタイミング
==========

ダンジョンをクリアしたり、ゲームオーバーになった時に自動的にリセットされるタイミングは `Dungeon から抜けて World に戻った時` です。

例えば力尽きた時、一度 ExitMap に遷移しますが、その時点では HP は回復していません。


!!! note "戦闘不能時に即リセットの弊害"
    - 画面暗転時に Window に表示されている HP が全快して見えてしまう。
    - 蘇生系アイテムを使うタイミングが難しくなる。（特に、その場で復活するか帰還するかを選択するアイテムの実装が困難）
    - 例えばゲームオーバー時にイベントが発生し、そこでの結果に応じて冒険に復帰、といったことができる柔軟性が無くなる。
    - (開発的な事情として) 攻撃>戦闘不能処理>マップ遷移>ステータスリセット が同一のコマンドチェーンで実行されるため、ユニットテストが難しくなる。

