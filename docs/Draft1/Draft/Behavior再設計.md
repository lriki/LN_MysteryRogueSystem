Behavior再設計
==========


各モンスターの思考パターン
- アイテム化けなど固有の状態が入ることがあるため、動的なBehavior

特定の行動
- 攻撃
- 壁掘り

アイテム効果
- 特に壺は固有の Behavior を書かないときつそう

エディタ側ではどんな設定をしたい？
- エネミーやアイテムに、どの Behavior を割り当てるか
例えば合成の壺を考えると、3つの共通部品が必要になる。
- Item
- Jar (中に何かアイテムが入ったCommandをthisに送る)
- SyntheticJar (新しいアイテムを作り、容量を減らす)
これ3つをエディタからいちいち指定しないとならないのはちょっと億劫。SyntheticJar にまとめたいところ。

一方複数指定したいケースは、例えば武器の「ごんぼう」
- Item (全武器共通)
- Weapon (全武器共通)
- Food (ごんぼうだけ)
ここで注意点は、Food が Item を継承ないし包含していると、Weapon の Item と競合すること。

新種アイテムをちょっと考える。

一時しのぎの杖+場所がえで、即降りの効果をもつ杖が作れたりする。
http://shiren2424.blog.fc2.com/blog-entry-129.html

追加できるのは Entity の状態を変更するようなものだけみたい。
https://seesaawiki.jp/w/shiren5/d/%bf%b7%bc%ef%c6%bb%b6%f1
壺は無理。
「印」で定義できる…というか、 Static な Behavior で表現できるものに限る気がする。

新種アイテムの考えを受けてみると、Behavior は大きく、Static なものと Dynamic なものに分けられそう。
巻物だと、
- Static: 修正値の強化など
- Dynamic: 聖域の巻物など… 床に張り付く、など状態を持つ

Static な Behavior は、ツクールの Trait とほぼ同一の考え方になる。

### 白紙の巻物

Entity に Attach する Behavior 自体を動的に変える必要があるもののひとつ。
「巻物」という性質は変わらない。

### エディタからの指定、再考

多分、ベースとなる種別 + Trait のように指定するのが一番いい気がする。
ベースとなる種別は既に考えてあるけど、アイコンのことだと思えばいい。

そうすると BaseBehavior と AdditionalBehavior みたいな2種類の Behavior を考えたほうがいいかも。
また AdditionalBehavior は BaseBehavior をオーバーライドできる。
例えば、壺は普通は容量を持ちアイテムを入れることができるが、ビックリの壺は見ることも入れることもできない。

### アイテム化

ンドゥバ系は BaseBehavior として ItemBehavior を持つべきかどうか。

### ItemBehavior 必要？

まず Item 固有の機能が思いつかない…。

すべての Entity はインベントリに入れることができるし、名前、アイコン、説明文なども持っている。
価格も持つし、値札もつけられる。売買もできる。

そう考えると、Player や Enemy など能動的に動き回る Entity の方が特殊な状態であって、
基本は地面レイヤー上に転がっているのを基本と考えたほうがいいのかも。

シレン2の土偶アイテムがイメージしやすいか。



