実装設計-杖
==========

[2021/2/14] 魔法弾について
----------

魔法弾自体は Entity であるが、その性質はデータベースで定義されるものではない。

普通の杖であれば、杖自体が効果を持っている。
魔法弾は生成されたとき、この効果をコピーして保持する Entity となる。

草受け・草投げの実装では、杖が持っている効果ではなく、草が持っている効果をコピーして保持する。


<RE-Reaction:Wave=ShotMagicBallet> はアイテム側につく点に注意。
Ability 側につけてしまうと、新種道具として振った時に魔法弾が2つ出てしまわないように対策する必要がある。

またこれによって「城の材料：木」とふきとばしAbilityを共有できるようになる。


リスト (シレン2)
----------

### 回復の杖

### からぶりの杖

### クオーターの杖

### 草受けの杖

### 草投げの杖

### ころばぬ先の杖

### しあわせの杖

### とうめいの杖

### 鈍足の杖

### トンネルの杖

### のりうつりの杖

### 倍速の杖

### 場所がえの杖

### 火ばしらの杖

### 引きよせの杖

### 封印の杖

### ふきとばしの杖

```
Ability (ステート):
<RE-Kind:Ability>
<RE-Key:kKnockbackAbility>
<RE-Reaction:Collide=Knockback(10)>      # 投げて当たった時、または魔法弾が当たった時
```

```
アイテム:
<RE-Key:kKnockbackStaff>
<RE-Kind:Staff>
<RE-Reaction:Wave=ShotMagicBallet>   # "振った"
<RE-Ability:kKnockbackAbility>
<RE-Capacity:5-7>   # 容量 5-7 で出現する
```

```
EKnockback:
吹き飛ばし効果及びダメージを与える Effect.
吹き飛ばし距離は引数で受け取る。
ダメージはアタッチされているアイテム情報から得る。
```


### 不幸の杖

### 物知りの杖


リスト (シレン5)
----------

### 土塊の杖 (魔法弾が出ない)

```
Ability (ステート):
<RE-Key:kSpawnFortAbility>
<RE-Kind:Ability>
<RE-Reaction:Wave=ESpawnFort>   # "振った"
# Hit= は定義しない（デフォルトの動作＝1ダメージ）
```

```
アイテム:
<RE-Key:kFortStaff>
<RE-Kind:Staff>
<RE-Ability:kSpawnFortAbility>
```



新種道具について
----------

```
アイテム:
<RE-Kind:Staff>
<RE-Ability:kKnockback>     # 最初にこれの RE-Effect:Hit= を適用する
<RE-Ability:kParalsis>      # 次にこれの RE-Effect:Hit= を適用する
```











